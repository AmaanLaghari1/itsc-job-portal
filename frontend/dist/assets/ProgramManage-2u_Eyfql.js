import{K as F,r as n,f as M,H as R,j as s}from"./index-CFt1f066.js";import{a as T}from"./QualificationRequest-CgT17vlK.js";import{C as V}from"./CustomSelect-BVXkPcO2.js";import{F as D,a as x,b as q}from"./formik.esm-DGj08CUs.js";import{D as B}from"./DynamicDataTable-BLKAN8eu.js";import{M as G}from"./Modal-Cpea3hEd.js";import{F as _}from"./FormControl-CxxYqU6g.js";import{A as C}from"./Alert-CXLFhIlH.js";import{c as U,a as $}from"./index.esm-g-bgoICI.js";import{a as z}from"./index.esm-DJsCAX2S.js";import"./CConditionalPortal-DZpQ5pqL.js";import"./isSymbol-ByaixRsz.js";import"./CFormLabel-Dy6tVY1e.js";const p=F.create({baseURL:"https://careers.usindh.edu.pk/backend/api/degree_program/"}),H=i=>p.get("discipline/get/"+i,{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}}),K=i=>p.post("discipline/post",i,{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}}),J=(i,l)=>p.put("discipline/put/"+l,i,{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}}),Q=(i,l)=>p.put("discipline/status/update/"+l,i,{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}}),le=()=>{const[i,l]=n.useState([]),[y,u]=n.useState([]),[o,f]=n.useState(null),[P,A]=n.useState(null),[v,I]=n.useState(!1),b=M(e=>e.roles.selectedRole),j=e=>{I(!0),f(e)},E=()=>{I(!1),f(null)},N=async()=>{try{const e=await T();l(e.data.options)}catch(e){console.log(e)}};n.useEffect(()=>{N()},[]);const S=n.useMemo(()=>R(i,"DEGREE_ID","DEGREE_TITLE"),[i]),w=async(e,t)=>{t("degree_id",(e==null?void 0:e.key)||"");try{const a=await H(e==null?void 0:e.key);u(a.data.data),A(e==null?void 0:e.key)}catch(a){console.log(a)}},k=async(e,{setSubmitting:t})=>{var a,c,m,d;try{if(o){const r=await J(e,o.DISCIPLINE_ID);u(h=>h.map(g=>g.DISCIPLINE_ID===o.DISCIPLINE_ID?{...g,DISCIPLINE_NAME:e.discipline_name}:g)),C({status:!0,text:((a=r==null?void 0:r.data)==null?void 0:a.message)||"Discipline updated successfully..."})}else{const r=await K(e);console.log(r),u(h=>[...h,{DISCIPLINE_ID:r.data.data.DISCIPLINE_ID,DISCIPLINE_NAME:e.discipline_name}]),C({status:!0,text:((c=r==null?void 0:r.data)==null?void 0:c.message)||"Discipline added successfully..."})}t(!1),E(),N()}catch(r){C({status:!1,text:(d=(m=r.response)==null?void 0:m.data)==null?void 0:d.error_message}),t(!1)}},L=[{name:"ID",selector:e=>e.DISCIPLINE_ID,sortable:!0,width:"80px"},{name:"Discipline Name",selector:e=>e.DISCIPLINE_NAME,sortable:!0},{name:"Actions",cell:e=>b===1||b===2?s.jsx("div",{className:"d-flex align-items-center flex-wrap gap-1",children:s.jsx("button",{className:"btn btn-outline-success btn-sm",onClick:()=>{j(e)},children:"Edit"})}):"-",ignoreRowClick:!0,width:"80px"},{name:"Active",cell:e=>s.jsx(s.Fragment,{children:s.jsx(D,{initialValues:{active:e.ACTIVE},onSubmit:async t=>{try{const a=await Q(t,e.DISCIPLINE_ID)}catch(a){console.log(a)}},children:({values:t,setFieldValue:a,submitForm:c})=>s.jsx(x,{children:s.jsxs("div",{className:"form-check form-switch",children:[s.jsx(q,{className:"form-check-input",name:"active",type:"checkbox",role:"switch",id:"active",checked:e.ACTIVE==1,onChange:m=>{const d=m.target.checked?1:0;a("active",d),c()}}),s.jsx("label",{className:"form-check-label",htmlFor:"active"})]})})})}),sortable:!0,width:"100px"}];return s.jsxs("div",{children:[s.jsx("div",{className:"row mb-3",children:s.jsx(D,{initialValues:{degree_id:""},onSubmit:()=>{},children:({values:e,setFieldValue:t})=>s.jsx(x,{children:s.jsx(V,{className:"form-control form-control-sm bg-primary text-light",label:"Select Program",name:"degree_id",options:S,onChange:a=>{w(a,t)},required:!0})})})}),s.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>{j(null)},children:"Add New +"}),s.jsx(B,{title:"Disciplines",columns:L,data:y}),s.jsx(G,{setVisible:I,visible:v,size:"md",position:"center",onClose:E,children:s.jsx(D,{initialValues:{degree_id:P||"",discipline_id:o?o.DISCIPLINE_ID:"",discipline_name:o?o.DISCIPLINE_NAME:""},validationSchema:U({discipline_name:$().required("Discipline is required!")}),onSubmit:k,children:({setFieldValue:e,isSubmitting:t})=>s.jsxs(x,{children:[s.jsx("h3",{children:o?"Edit Discipline":"Add Discipline"}),o?"":s.jsx("div",{className:"form-group my-2",children:s.jsx(_,{control:"select",label:"Program",name:"degree_id",options:S,disabled:!0})}),s.jsx("div",{className:"form-group my-2",children:s.jsx(_,{control:"input",name:"discipline_name",label:"Discipline Name",onInput:a=>{a.target.value=a.target.value.toUpperCase()},required:!0})}),s.jsx(z,{variant:"success",className:"text-light",type:"submit",disabled:t,children:t?"Saving...":"Save"})]})})})]})};export{le as default};
