import{r as o,w as S,i as P,f as N,x as D,j as n,n as g,y,z as j}from"./index-BFSWvyhh.js";import{D as U}from"./DynamicDataTable-DMTjRBex.js";import{g as M}from"./UtilRequest-82-ViOBi.js";import{C as h}from"./CustomSelect-BtwL3Ue1.js";import{F as v,a as k}from"./formik.esm-Bg87zhII.js";import{c as L}from"./index.esm-DKed_wgO.js";import"./isSymbol-B98uY8n-.js";import"./CConditionalPortal-DaAJL4r3.js";const $=()=>{const[I,l]=o.useState([]),d=S(),[p,x]=o.useState([]),[c,u]=o.useState([]),A=P(),r=N(e=>e.applicationFilter.selectedDeptId),m=N(e=>e.applicationFilter.selectedAnnouncementId);o.useEffect(()=>{(async()=>{try{const t=await M();if(x(t.data),r){const s=t.data.find(a=>a.DEPT_ID==r);if(s&&(u(s.announcements),m)){const a=s.announcements.find(i=>i.ANNOUNCEMENT_ID==m);a&&l(a.applications)}}}catch(t){console.error("Error loading dept/announcement data",t)}})()},[]);const T=o.useMemo(()=>D(p,"DEPT_ID","DEPT_NAME")),f=o.useMemo(()=>D(c,"ANNOUNCEMENT_ID","ANNOUNCEMENT_TITLE")),_=[{name:"ID",selector:e=>e.APPLICATION_ID,sortable:!0,width:"80px"},{name:"Candidate Name",selector:e=>e.FIRST_NAME+" "+e.LAST_NAME,sortable:!0,width:"250px",style:{minWidth:"250px",maxWidth:"300px"}},{name:"CNIC No.",selector:e=>e.CNIC_NO,sortable:!0,wrap:!0,style:{minWidth:"150px"}},{name:"Paid Amount",selector:e=>e.PAID_AMOUNT??"-",sortable:!0,width:"130px"},{name:"Apply Date",selector:e=>e.APPLY_DATE??"-",sortable:!0,style:{minWidth:"100px"}},{name:"Paid Date",selector:e=>e.PAID_DATE?g(e.PAID_DATE):"-",sortable:!0,width:"130px"},{name:"Status",selector:e=>e.APPLICATION_STATUS==1?"Applied":e.APPLICATION_STATUS==2?"Unpaid":e.APPLICATION_STATUS==4?"Shortlisted":e.APPLICATION_STATUS==3?"Recieved":"Rejected",sortable:!0,width:"100px"},{name:"Actions",cell:e=>n.jsxs("div",{className:"d-flex align-items-center flex-wrap gap-1",children:[n.jsx("button",{className:"btn btn-outline-warning btn-sm",onClick:()=>{d("/admin/application/edit",{state:{prevData:e,announcement:c.filter(t=>t.ANNOUNCEMENT_ID===e.ANNOUNCEMENT_ID)}})},children:"View"}),n.jsx("button",{className:"btn btn-outline-success btn-sm",onClick:()=>{d("/admin/application/update-user",{state:{prevData:e}})},children:"Update User"}),n.jsx("button",{className:"btn btn-outline-danger btn-sm",children:"Delete"})]}),ignoreRowClick:!0,width:"220px"}],E=(e,t)=>{t("dept_id",(e==null?void 0:e.key)||"");const s=(e==null?void 0:e.key)||"",a=p.filter(i=>i.DEPT_ID==e.key);A(y(s)),u(a[0].announcements)},b=(e,t)=>{t("announcement_id",(e==null?void 0:e.key)||"");const s=(e==null?void 0:e.key)||"",a=c.filter(i=>i.ANNOUNCEMENT_ID==e.key);A(j(s)),l(a[0].applications)},C=I.map(e=>e);return n.jsxs("div",{className:"admin-dashboard",children:[n.jsx(v,{enableReinitialize:!0,initialValues:{dept_id:r,announcement_id:m},validationSchema:L({}),children:({setFieldValue:e})=>n.jsx(k,{children:n.jsxs("div",{className:"row",children:[n.jsx("div",{className:"form-group col-6 my-2",children:n.jsx(h,{className:"form-control bg-primary text-light",label:"Select Department",name:"dept_id",options:T,onChange:t=>{E(t,e)},required:!0})}),n.jsx("div",{className:"form-group col-6 my-2",children:n.jsx(h,{className:"form-control bg-primary text-light",label:"Select Announcement",name:"announcement_id",options:f||[],onChange:t=>{b(t,e)},required:!0})})]})})}),n.jsx(U,{title:"Applications",columns:_,data:C})]})};export{$ as default};
